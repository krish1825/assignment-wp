var WaterfallDenseGridAccessibility;(function(n){function rt(){if(u){var n=u.gfbc("dgControl",_d);n&&(b=u.ga(n,"data-afcsot")==="1",o=u.gebc(tt,n),o.length>0&&(s(),sj_evt.bind("DenseGridResultsUpdated",s),sj_be(_w,"resize",s),sj_be(n,"keydown",k),sj_be(_w,"unload",y),sj_evt.bind("ajax.unload",y)))}}function s(){var i,n,t,u;if(o.length>0)for(e=[],c=[],l=[],a=[],i=0;i<o.length;i++){var f=o[i],s=[],h=[],v=[],r=[];for(n=0;n<f.childNodes.length;n++)t=f.childNodes[n],s[n]=t.offsetTop,h[n]=t.clientHeight,v[n]=nt(t),u=t.querySelector(".iusc,.ent a"),u?r.push(u):r.push(t);c.push(s);l.push(h);a.push(v);e.push(r)}}function k(n){var s=ut(n),c=(n===null||n===void 0?void 0:n.key)||"",a=function(){return!!_w.IsSearchAppXYFocusEnabled},y,k,l,tt,o,it;if((s===9||c===f.Tab)&&typeof WFDenseGridA11y_Tab!="undefined"){WFDenseGridA11y_Tab.handleImageResultsKeyDown(n);return}if(s==39||c===f.ArrowRight){if(t+1<e.length)y=d(t+1,t,r),v(t+1,y);else if(a())return;h(n)}else if(s==37||c===f.ArrowLeft){if(t-1>=0)y=d(t-1,t,r),v(t-1,y);else if(a())return;h(n)}else if(s==38||c===f.ArrowUp){if(r-1>=0)v(t,r-1);else if(a())return;h(n)}else if(s==40||c===f.ArrowDown){if(r+1<e[t].length)v(t,r+1);else if(a())return;h(n)}else(s==9||c===f.Tab)&&(k=document.activeElement,l=!1,i&&(tt=u.gaebc(w,i),tt&&(o=p("a",tt),o=o.filter(function(n){return n.tabIndex!="-1"}),it=nt(tt.parentElement),b?l=!0:n.shiftKey&&(o.length==0||k==o[0])?(g(it-1,!0),l=!0):n.shiftKey||o.length!=0&&k!=o[o.length-1]||(g(it+1),l=!0))),l||(i=k))}function d(n,t,i){var r=l[t][i]/2+c[t][i],u=c[n],f=l[n];if(u[i]<=r&&u[i]+f[i]>=r)return i;if(u[i]>r)while(i>0&&u[i]>r)i--;else while(i<f.length-1&&u[i]+f[i]<r)i++;return i}function v(n,u){if((n!=t||u!=r)&&(i&&(i.tabIndex=-1),n<e.length)){t=n;var f=e[n];u<f.length&&(r=u,i=f[u],i.tabIndex=0,i.focus())}}function h(n){return sj_sp(n),sj_pd(n),!1}function ut(n){return n?n.which?n.which:n.keyCode:-1}function y(){sj_evt.unbind("DenseGridResultsUpdated",s);sj_ue(_w,"resize",s);sj_ue(it,"keydown",k);sj_ue(_w,"unload",y);sj_evt.unbind("ajax.unload",y)}function p(n,t){var f=[],u,i,r;if(t)for(u=t.getElementsByTagName(n),i=0;i<u.length;i++)r=u[i],(r.offsetHeight>0||r.offsetWidth>0)&&f.push(r);return f}function g(n,t){var f,e,r;t===void 0&&(t=!1);f=ft(n);f&&(t&&(e=u.gaebc(w,f),r=p("a",e||f),r=r.filter(function(n){return n.tabIndex!="-1"}),r&&r.length>0&&(f=r[r.length-1])),i=f,i.focus(),h(event))}function nt(n){var i=u.gpc(n,"LI"),t=parseInt(u.ga(i,"data-idx"));return t?t:-1}function ft(n){var t,r,i,u;if(n<=0)return null;for(t=0;t<a.length;t++)for(r=a[t],i=0;i<r.length;i++)if(u=r[i],u>n)continue;else if(u===n)return e[t][i];return null}var t=0,r=0,i,w="iuscp",tt="dgControl_list",e,o,it,c,l,a,b=!1,u=typeof pMMUtils!="undefined"?pMMUtils:null,f;(function(n){n.ArrowLeft="ArrowLeft";n.ArrowRight="ArrowRight";n.ArrowUp="ArrowUp";n.ArrowDown="ArrowDown";n.Tab="Tab"})(f||(f={}));n.getVisibleElementsByTagName=p;rt()})(WaterfallDenseGridAccessibility||(WaterfallDenseGridAccessibility={}))